---
layout: default
title: How to verify elasticsearch shard mechanism working
description: Step to verify elasticsearch sharding mechanism working
keywords: verify elasticsearch sharding, cluster, distribute
index: false
comments: disqus
---
<h3>
<a href="#how-to-verify-elasticsearch-shard" name="how-to-verify-elasticsearch-shard" class="anchor"><span class="octicon octicon-link"></span></a>
{{ page.title }}
</h3>
<p>
elasticsearch distrubte is looks simple as magic, just start and you will be there.
</p>

<p>
node discovery
	magic simple
	broadcast
	per to per
</p>

<p>
however anyway you need to know how it works.
how to verify? two words answer: disable replication
</p>

<h3>
<a href="#install" name="install" class="anchor"><span class="octicon octicon-link"></span></a>
prepare install
</h3>

<p>
download unzip blabla...
</p>

<p>
modify elasticsearch.yml
	cluster.name
	node.name
	index.number_of_replicas: 0
</p>

<p>
startup
</p>

<p>
check status
	http://localhost:9200/_cluster/health?pretty=true
	http://localhost:9200/_cluster/state
</p>

<h3>
<a href="#index" name="index" class="anchor"><span class="octicon octicon-link"></span></a>
index
</h3>

<pre><code>
	$ curl -XPUT 'http://localhost:9200/_bulk' -d '
		{"index":{"_index":"shakespeare","_type":"act","_id":0}}
		{"line_id":1,"play_name":"Henry IV","speech_number":"","line_number":"","speaker":"","text_entry":"ACT I"}
		{"index":{"_index":"shakespeare","_type":"scene","_id":1}}
		{"line_id":2,"play_name":"Henry IV","speech_number":"","line_number":"","speaker":"","text_entry":"SCENE I. London. The palace."}
		{"index":{"_index":"shakespeare","_type":"line","_id":2}}
		{"line_id":3,"play_name":"Henry IV","speech_number":"","line_number":"","speaker":"","text_entry":"Enter KING HENRY, LORD JOHN OF LANCASTER, the EARL of WESTMORELAND, SIR WALTER BLUNT, and others"}
		{"index":{"_index":"shakespeare","_type":"line","_id":3}}
		{"line_id":4,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.1","speaker":"KING HENRY IV","text_entry":"So shaken as we are, so wan with care,"}
		{"index":{"_index":"shakespeare","_type":"line","_id":4}}
		{"line_id":5,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.2","speaker":"KING HENRY IV","text_entry":"Find we a time for frighted peace to pant,"}
		{"index":{"_index":"shakespeare","_type":"line","_id":5}}
		{"line_id":6,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.3","speaker":"KING HENRY IV","text_entry":"And breathe short-winded accents of new broils"}
		{"index":{"_index":"shakespeare","_type":"line","_id":6}}
		{"line_id":7,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.4","speaker":"KING HENRY IV","text_entry":"To be commenced in strands afar remote."}
		{"index":{"_index":"shakespeare","_type":"line","_id":7}}
		{"line_id":8,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.5","speaker":"KING HENRY IV","text_entry":"No more the thirsty entrance of this soil"}
		{"index":{"_index":"shakespeare","_type":"line","_id":8}}
		{"line_id":9,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.6","speaker":"KING HENRY IV","text_entry":"Shall daub her lips with her own childrens blood;"}
		{"index":{"_index":"shakespeare","_type":"line","_id":9}}
		{"line_id":10,"play_name":"Henry IV","speech_number":1,"line_number":"1.1.7","speaker":"KING HENRY IV","text_entry":"Nor more shall trenching war channel her fields,"}
	'
</code></pre>

<p>
query
	http://localhost:9200/_search?q=*
</p>

<h3>
<a href="#verify" name="verify" class="anchor"><span class="octicon octicon-link"></span></a>
verify
</h3>

<p>
check folder
	\elasticsearch-1.2.1\data\my_elasticsearch\nodes\0\indices\shakespeare\ (0 2 4)
	\elasticsearch-1.2.1\data\my_elasticsearch\nodes\0\indices\shakespeare\ (1 3)
</p>

<p>
shutdown the second node
</p>

<p>
query
	http://localhost:9200/_search?q=*
</p>

<p>
check status
	http://localhost:9200/_cluster/health?pretty=true (red)
	[what is yellow]
</p>

<h3>
<a href="#conclusion" name="conclusion" class="anchor"><span class="octicon octicon-link"></span></a>
in conclusion
</h3>

<p>
this article is about...
please enable replication if want reliability
</p>

<h3>
<a href="#reference" name="reference" class="anchor"><span class="octicon octicon-link"></span></a>
Reference
</h3>

<p>
http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/modules-discovery.html
http://stackoverflow.com/questions/15694724/shards-and-replicas-in-elasticsearch
</p>
